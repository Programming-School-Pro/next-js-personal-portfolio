<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://sreetamdas.com</id>
    <title>Sreetam Das' blog</title>
    <updated>2021-04-06T03:57:35.329Z</updated>
    <generator>Feed for Node.js</generator>
    <author>
        <name>Sreetam Das</name>
        <email>sreetam@sreetamdas.com</email>
        <uri>https://twitter.com/_SreetamDas</uri>
    </author>
    <link rel="alternate" href="https://sreetamdas.com"/>
    <link rel="self" href="https://sreetamdas.com/rss/atom.xml"/>
    <subtitle>Beginner friendly developer content, with a focus on React, TypeScript, Next.js and Styled-components</subtitle>
    <logo>https://sreetamdas.com/logo.svg</logo>
    <icon>https://sreetamdas.com/favicon.png</icon>
    <rights>All rights reserved 2021, Sreetam Das</rights>
    <entry>
        <title type="html"><![CDATA[Year in Review — 2020]]></title>
        <id>https://sreetamdas.com/blog/year-in-review-2020</id>
        <link href="https://sreetamdas.com/blog/year-in-review-2020"/>
        <updated>2021-01-17T00:00:00.000Z</updated>
        <content type="html"><![CDATA[<p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">2020 was a weird year for us all, but here&#x27;s everything that I was able to do this year anyway:</p><div><h2 id="finally-launched-my-blog" style="color:var(--color-primary-accent)"><a href="#finally-launched-my-blog" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="finally-launched-my-blog" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Finally launched my blog!</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">At the beginning of 2020, I set out to redo my personal website. I was fairly impressed with how I’d built it (<span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="/blog/over-engineering-a-blog">over-engineered</a></span> and such), and also with how my blog post — which was a big motivation for revamping my website in the first place — had started to take shape. After months of work (and procrastination), I published my blog post in late November.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I crossposted it to <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://dev.to/sreetamdas/the-perfect-dark-mode-2d7g" target="_blank" rel="noopener noreferrer">dev.to</a></span> and <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://sreetamdas.hashnode.dev/the-perfect-dark-mode" target="_blank" rel="noopener noreferrer">Hashnode</a></span>, and posted it on <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://www.reddit.com/r/reactjs/comments/jywex9/the_perfect_dark_mode_in_nextjs/" target="_blank" rel="noopener noreferrer">Reddit</a></span> as well. It also got picked up by <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://react.statuscode.com/issues/217" target="_blank" rel="noopener noreferrer">React Status</a></span> and the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://stackoverflow.blog/2020/12/11/17089/#h-links-from-around-the-web" target="_blank" rel="noopener noreferrer">Stack Overflow newsletter</a></span>!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;d planned quite a bit for its release, but that still didn&#x27;t prepare me for the sheer number of people who read my blog post — between all three platforms that I posted on, over <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">15 thousand</span> checked out the post!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s what I wanna say to you — if you&#x27;ve got <em>that one article</em> that you&#x27;ve been sitting on for weeks/months, get it out there! You&#x27;d be surprised at how many people find it intriguing :)</p><div><h2 id="became-more-active-on-twitter" style="color:var(--color-primary-accent)"><a href="#became-more-active-on-twitter" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="became-more-active-on-twitter" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Became more active on Twitter</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">There&#x27;s tons of great content on Twitter <em>if you&#x27;re following the right people</em> — I realised that in a year without much physical interaction with people, Twitter is a great outlet for thinking out loud; I got loads of feedback and motivation from people. Heck, I even got a job interview just because I was following someone who posted about it! The highlight of it all was getting followed by <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/Netlify" target="_blank" rel="noopener noreferrer">@Netlify</a></span> and <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/cassidoo" target="_blank" rel="noopener noreferrer">@cassidoo</a></span>!</p><div><h2 id="got-a-new-job" style="color:var(--color-primary-accent)"><a href="#got-a-new-job" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="got-a-new-job" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Got a new job!</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Late last year I <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/_SreetamDas/status/1326004455397969920" target="_blank" rel="noopener noreferrer">started working</a></span> at <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://remote.com" target="_blank" rel="noopener noreferrer">Remote</a></span>, and I got to work at a company that is everything that I had ever dreamed of. It really does &quot;walk the talk&quot; of working remote and async!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We also have a public <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://handbook.remote.com" target="_blank" rel="noopener noreferrer">handbook</a></span> that I recommend everyone to check out (<span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://www.notion.so/remotecom/Values-d43475e8895c4b7c811490aef64782b3" target="_blank" rel="noopener noreferrer">Our number one value is kindness</a></span> 🙂)</p><div><h2 id="a-year-of-firsts" style="color:var(--color-primary-accent)"><a href="#a-year-of-firsts" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="a-year-of-firsts" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>A Year of Firsts</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Working from home (for so long!) was a first for a lot of us, but in addition, I also:</p><ul><li>got a <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/_SreetamDas/status/1342839171287666691" target="_blank" rel="noopener noreferrer">chance to speak at a conf</a></span> for the first time (which got <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://reactday.in" target="_blank" rel="noopener noreferrer">postponed to March &#x27;21</a></span> 😭)</li><li>got to <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/_SreetamDas/status/1336932419497197569" target="_blank" rel="noopener noreferrer">play in VR</a></span> (thanks <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://remote.com" target="_blank" rel="noopener noreferrer">@Remote</a></span>!) It is one thing to read up and/or watch LTT videos about it, but nothing prepares you for the moment when you get to experience it firsthand</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="Magicforce Smart 2 with Gateron Browns" src="/blog/year-in-review-2020/oculus.jpg" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p><ul><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">took part in <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://adventofcode.com" target="_blank" rel="noopener noreferrer">Advent of Code</a></span>, albeit I could only keep up for nine days; You can find my solutions <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://gist.github.com/sreetamdas/a094dc7cc17b75dc7563e04240cf5618" target="_blank" rel="noopener noreferrer">here</a></span></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Got more into mechanical keyboards
<img alt="Magicforce Smart 2 with Gateron Browns" src="/blog/year-in-review-2020/keyboard.jpg" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">started doing the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://www.nytimes.com/crosswords/game/mini" target="_blank" rel="noopener noreferrer">New York Times Mini Crossword</a></span> <em>almost</em> regularly</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">treated myself for 2020 with the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://www.sony.com/electronics/headband-headphones/wh-1000xm4" target="_blank" rel="noopener noreferrer">Sony WH-1000XM4</a></span></p></li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="Sony WH-1000XM4" src="/blog/year-in-review-2020/headphones.jpg" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p><ul><li>released <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://marketplace.visualstudio.com/items?itemName=SreetamD.karma" target="_blank" rel="noopener noreferrer">Karma</a></span>: a custom theme for VSCode, and I&#x27;m so so proud that it was good enough for 2500+ people to install it!</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="Karma: a VSCode theme" src="/blog/year-in-review-2020/karma.png" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;m not great at keeping resolutions, but I came up with a list of things that I hope to do in 2021:</p><ul><li>Become better at fullstack develop and build an app, no matter the size</li><li>Learn in public</li><li>Help more people learn how to code (and get better myself)</li><li>Be more consistent with posts on my blog and my newsletter</li><li>Hopefully get to speak at offline events and also conquer my stage fright (or whatever&#x27;s left of it)</li><li>Get better at CSGO (<span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/_SreetamDas" target="_blank" rel="noopener noreferrer">reach out</a></span> to me if you wanna <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://steamcommunity.com/id/sreetamdas" target="_blank" rel="noopener noreferrer">play</a></span> along with me!)</li><li><del>Improve my Remote work setup (should have some updates soon!)</del> I received my setup! You can also check out my <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="/uses">/uses</a></span> page!</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="My setup" src="/blog/year-in-review-2020/setup.jpg" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p>]]></content>
        <author>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </author>
        <contributor>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </contributor>
    </entry>
    <entry>
        <title type="html"><![CDATA[The Perfect Dark Mode]]></title>
        <id>https://sreetamdas.com/blog/the-perfect-dark-mode</id>
        <link href="https://sreetamdas.com/blog/the-perfect-dark-mode"/>
        <updated>2020-11-22T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[How hard can implementing the perfect dark mode be? A journey through blocking scripts, IIFEs, CSS variables and much more]]></summary>
        <content type="html"><![CDATA[<p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I am a huge fan of <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://joshwcomeau.com" target="_blank" rel="noopener noreferrer">Josh W Comeau</a></span>&#x27;s website as well as the content that he puts out. He has some very, very interesting articles, but by far the most interesting one is about his <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://joshwcomeau.com/gatsby/dark-mode" target="_blank" rel="noopener noreferrer">Quest for The Perfect Dark Mode</a></span>.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">It is a perfect read, equal parts technical and entertaining and quite frankly, an inspiration for how a technical blog post should be written. I&#x27;ve read it in its entirety more than thrice, and at the end of the third read, I just knew that I had to try it out.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s the small problem though: Josh implemented it in <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://gatsbyjs.org" target="_blank" rel="noopener noreferrer">Gatsby</a></span>. Meanwhile, my blog is built using <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://nextjs.org" target="_blank" rel="noopener noreferrer">Next.js</a></span>. (Both of these implement static-ish websites with React, I write more about this in my <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="/blog/over-engineering-a-blog">previous blog post</a></span>)</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">If you haven&#x27;t already, please go through Josh&#x27;s post first if you want to be able to follow along. Well, into uncharted waters we go!</p><div><h2 id="the-problem" style="color:var(--color-primary-accent)"><a href="#the-problem" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="the-problem" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>The Problem</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">So what&#x27;s the big deal? What really is the <em>perfect</em> dark mode?</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">If you take a look at a website which has support for dark mode like <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://mdxjs.com" target="_blank" rel="noopener noreferrer">mdxjs.com</a></span>, you&#x27;ll notice something if you try to refresh the page once you&#x27;ve enabled dark mode.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="gif showing MDXJS&#x27; website flicker before toggling dark mode on refresh" src="/blog/the-perfect-dark-mode/perfect-dark-mode-mdxjs-flicker.gif" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The dreaded flicker of light mode. <em>ugh</em>.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">So why does this happen?</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">This is a problem that is not limited to static/hybrid websites but extends to pretty much any website that uses JavaScript to &quot;hydrate&quot; its components. This is because when our page loads up, here&#x27;s that happens:</p><ul><li>The HTML gets loaded first, which in turn loads the JS and CSS</li><li>By default, a webpage has a <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background-color#Formal_definition" target="_blank" rel="noopener noreferrer"><code>transparent</code> background color</a></span>, which means that you&#x27;ll get a <strong>white</strong> background unless you&#x27;re using certain extensions</li><li>The HTML can contain inline CSS to set the background color so that we don&#x27;t see the &quot;flicker&quot; but currently, <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://stackoverflow.com/a/9808297/5283213" target="_blank" rel="noopener noreferrer">inline CSS doesn&#x27;t support media queries</a></span> so we can&#x27;t find out <em>if</em> the user even prefers dark mode</li><li>the JS loaded first needs to be parsed before it starts to &quot;hydrate&quot; the page. If there&#x27;s any preference for dark mode that has been stored (usually using local storage), it&#x27;s also loaded by the JS. This means that until all this has been done, our user <em>still</em> sees only what the HTML has described: a <strong>transparent</strong> background.</li></ul><div><h2 id="the-solution" style="color:var(--color-primary-accent)"><a href="#the-solution" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="the-solution" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>The Solution</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">So what should we do? We need to find a way to be able to run some code and apply the appropriate <code>background-color</code> (and by extension, the theme) <em>before</em> the entire page has loaded.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s a rough list of what we need to implement:</p><ul><li>if the user has visited our site before, then we use their saved preference</li><li>if the user hasn&#x27;t visited our site before or hasn&#x27;t saved a preference, then we check if their Operating System has a preference and use the same</li><li>If the above two methods don&#x27;t return a preference still, then we default to a <strong>light</strong> theme</li><li>all the above checks need to be run <em>before</em> our page is rendered/shown to the user</li><li>allow the user to toggle dark mode, and save their preference for future reference</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Let&#x27;s start by putting together a simple Next.js page with a pretty basic dark mode toggle:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token comment" style="color:#444;font-style:italic">// pages/index.js</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;react&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">IndexPage</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token plain">isDarkTheme</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">useState</span><span class="token punctuation" style="color:#88898F">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">handleToggle</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain">    </span><span class="token function" style="color:#7BD88F">setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">ev</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">target</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">checked</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">input</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#88898F">=</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag attr-value" style="color:#FC618D">checkbox</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">checked</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">isDarkTheme</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">handleToggle</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token tag" style="color:#FC618D">        </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token punctuation" style="color:#88898F">{</span><span class="token string" style="color:#E3CF65">&quot; &quot;</span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token plain">        Dark</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">Hello there</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">General Kenobi</span><span class="token operator" style="color:#FC618D">!</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> IndexPage</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><div><h2 id="storing-and-retrieving-user-preference" style="color:var(--color-primary-accent)"><a href="#storing-and-retrieving-user-preference" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="storing-and-retrieving-user-preference" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Storing (and retrieving) user preference</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Let&#x27;s begin by adding the ability to store and retrieve the preference if the user has already visited our website before. <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://javascript.info/localstorage" target="_blank" rel="noopener noreferrer">localStorage</a></span> is a really simple way of accomplishing exactly this, even when a user refreshes the page or closes the browser completely and opens it again at a later time. Although there are concerns over storing sensitive and/or large data in localStorage, it is perfect for storing our user&#x27;s dark mode preference.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s how we can save and load our <code>theme</code> preference using <code>localStorage</code>:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-js" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token dom variable" style="color:#FD9353;font-style:italic">window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token property-access">localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token method function property-access" style="color:#7BD88F">setItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"> </span><span class="token comment" style="color:#444;font-style:italic">// or &quot;light&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> userPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#FD9353;font-style:italic">window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token property-access">localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token method function property-access" style="color:#7BD88F">getItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"> </span><span class="token comment" style="color:#444;font-style:italic">// &quot;dark&quot;</span></div></pre><div><h2 id="system-wide-preference" style="color:var(--color-primary-accent)"><a href="#system-wide-preference" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="system-wide-preference" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>System-wide preference</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme" target="_blank" rel="noopener noreferrer">prefers-color-scheme</a></span> is a CSS media feature that allows us to detect if the user has set any system-wide dark mode preferences, which we can use in case the user hasn&#x27;t set a preference yet.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">All we need to do is run a CSS media query, and the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia" target="_blank" rel="noopener noreferrer">browser provides us with <code>matchMedia()</code></a></span> to do exactly this!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s what a media query to check if the user has set any preference looks like:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-js" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mql </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token dom variable" style="color:#FD9353;font-style:italic">window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token method function property-access" style="color:#7BD88F">matchMedia</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;(prefers-color-scheme: dark)&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">with the output (when the user <em>has</em> set a preference for dark mode):</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-json" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSON</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token property" style="color:#D7D7D7">&quot;matches&quot;</span><span class="token operator" style="color:#FC618D">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  </span><span class="token property" style="color:#D7D7D7">&quot;media&quot;</span><span class="token operator" style="color:#FC618D">:</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;(prefers-color-scheme: dark)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Let&#x27;s add these to our app</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;react&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">IndexPage</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token plain">isDarkTheme</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">useState</span><span class="token punctuation" style="color:#88898F">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">handleToggle</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain">    </span><span class="token function" style="color:#7BD88F">setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">ev</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">target</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">checked</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">getMediaQueryPreference</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mediaQuery </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;(prefers-color-scheme: dark)&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mql </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">matchMedia</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">mediaQuery</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> hasPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">typeof</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;boolean&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">hasPreference</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">?</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">:</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">storeUserSetPreference</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter">pref</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">    localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> pref</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">getUserSetPreference</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">getItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">27</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">useEffect</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">28</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> userSetPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getUserSetPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">29</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">userSetPreference </span><span class="token operator" style="color:#FC618D">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">null</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">30</span><span class="token plain">      </span><span class="token function" style="color:#7BD88F">setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">userSetPreference </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">31</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">32</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mediaQueryPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getMediaQueryPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">33</span><span class="token plain">      </span><span class="token function" style="color:#7BD88F">setIsDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">mediaQueryPreference </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">34</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">35</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token punctuation" style="color:#88898F">]</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">36</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">useEffect</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">37</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">isDarkTheme </span><span class="token operator" style="color:#FC618D">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">undefined</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">38</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">isDarkTheme</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">39</span><span class="token plain">        </span><span class="token function" style="color:#7BD88F">storeUserSetPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">40</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">41</span><span class="token plain">        </span><span class="token function" style="color:#7BD88F">storeUserSetPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">42</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">43</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">44</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token plain">isDarkTheme</span><span class="token punctuation" style="color:#88898F">]</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">45</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">46</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">47</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">48</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">49</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">input</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">50</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#88898F">=</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag attr-value" style="color:#FC618D">checkbox</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">51</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">checked</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">isDarkTheme</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">52</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">handleToggle</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">53</span><span class="token tag" style="color:#FC618D">        </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token punctuation" style="color:#88898F">{</span><span class="token string" style="color:#E3CF65">&quot; &quot;</span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">54</span><span class="token plain">        Dark</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">55</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">56</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">Hello there</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">57</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">General Kenobi</span><span class="token operator" style="color:#FC618D">!</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">58</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">59</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">60</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">61</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">62</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> IndexPage</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><ul><li>when our page is loaded and our <code>IndexPage</code> component has been mounted, we retrieve the user&#x27;s set preference if they&#x27;ve already set one from their earlier visit</li><li>the <code>localStorage.getItem()</code> call returns <code>null</code> if they haven&#x27;t set one, and we move on to checking their system wide preference is dark mode</li><li>we default to light mode</li><li>whenever the user toggles the checkbox to turn dark mode on or off, we save their preference to <code>localStorage</code> for future use</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Great! We&#x27;ve got a toggle working, and we&#x27;re also able to store and retrieve the correct state in our page</p><div><h2 id="back-to-basics" style="color:var(--color-primary-accent)"><a href="#back-to-basics" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="back-to-basics" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Back to Basics</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The biggest challenge (surprisingly) was being able to run all these checks <em>before</em> anything is shown to the user. Since we&#x27;re using Next.js with its <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://nextjs.org/docs/basic-features/data-fetching" target="_blank" rel="noopener noreferrer">Static Generation</a></span>, there&#x27;s no way for us to know at code/build time what the user&#x27;s preference is going to be 🤷‍♂️</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Unless...there <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">was</span> a way run some code before all of our page is loaded and rendered to the user!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Take a look at the code below:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-html" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">HTML</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token script language-javascript"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token script language-javascript">    </span><span class="token script language-javascript function" style="color:#7BD88F">alert</span><span class="token script language-javascript punctuation" style="color:#88898F">(</span><span class="token script language-javascript string" style="color:#E3CF65">&quot;No UI for you!&quot;</span><span class="token script language-javascript punctuation" style="color:#88898F">)</span><span class="token script language-javascript punctuation" style="color:#88898F">;</span><span class="token script language-javascript"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token script language-javascript">  </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">Page Title</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s what it looks like:</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><img alt="gif showing blocking nature of &lt;script&gt; tags in HTML" src="/blog/the-perfect-dark-mode/perfect-dark-mode-blocking-script.gif" style="max-width:var(--max-width);width:100%;border-radius:var(--border-radius)"/></p><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr">If you&#x27;d like to try it out for yourself, check out this <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://codesandbox.io/s/sleepy-cartwright-ufhxs?file=/index.html" target="_blank" rel="noopener noreferrer">sandbox</a></span></aside><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">When we add a <code>&lt;script&gt;</code> in our body before our <code>&lt;h1&gt;</code> content, the rendering of the actual content is <em>blocked</em> by the script. This means that we can run code that will be guaranteed to run before any content is shown to the user, which is exactly what we wanna do!</p><div><h2 id="nextjs-document" style="color:var(--color-primary-accent)"><a href="#nextjs-document" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="nextjs-document" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Next.js&#x27; Document</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">From the example above, we know now that we need to add a <code>&lt;script&gt;</code> in the <code>&lt;body&gt;</code> of our page before the actual content.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Next.js provides a super sweet and easy way of modifying the <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags in our app by <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://nextjs.org/docs/advanced-features/custom-document" target="_blank" rel="noopener noreferrer">adding a <code>_document.tsx</code> (or <code>_document.js</code>) file</a></span>. The <code>Document</code> is only rendered in the server, so our script is loaded as we describe it on the client browser.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Using this, here&#x27;s how we can add our script:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> Document</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  Html</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  Head</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  Main</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  NextScript</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;next/document&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">class</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">MyDocument</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">Document</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">render</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Head</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">dangerouslySetInnerHTML</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token tag script language-javascript" style="color:#FC618D">              __html</span><span class="token tag script language-javascript operator" style="color:#FC618D">:</span><span class="token tag script language-javascript" style="color:#FC618D"> customScript</span><span class="token tag script language-javascript punctuation" style="color:#88898F">,</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token tag script language-javascript" style="color:#FC618D">            </span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Main</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">NextScript</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">27</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> customScript </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token template-string string" style="color:#E3CF65"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">28</span><span class="token template-string string" style="color:#E3CF65">        console.log(&quot;Our custom script runs!&quot;);</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">29</span><span class="token template-string string" style="color:#E3CF65"></span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr"><code>&lt;Html&gt;</code>, <code>&lt;Head /&gt;</code>, <code>&lt;Main /&gt;</code> and <code>&lt;NextScript /&gt;</code> are required for the page to be properly rendered.</aside><div><h2 id="dangerously-set-whaa" style="color:var(--color-primary-accent)"><a href="#dangerously-set-whaa" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="dangerously-set-whaa" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Dangerously set whaa?</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML" target="_blank" rel="noopener noreferrer">browser DOM provides us with <code>innerHTML</code></a></span> to get or set the HTML contained within an element. Usually, setting HTML from code is risky business because it is easy to inadvertently expose users to a <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting" target="_blank" rel="noopener noreferrer">cross-site scripting (XSS)</a></span> attack. React protects us from this by default, by <em>sanitising</em> the contents before rendering it.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">If a user tries to set their name to <code>&lt;script&gt;I&#x27;m dangerous!&lt;/script&gt;</code>, React encodes characters like <code>&lt;</code> into <code>&amp;lt;</code>. This way, the script has no effect.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">React also provides a way to override this behaviour using <code>dangerouslySetInnerHTML</code>, reminding us that <em>it is dangerous</em>. Well, in our use case, we actually <em>do</em> want to inject and run a script.</p><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr">Note how it requires us to pass the <code>innerHTML</code>, our script, as a <code>string</code></aside><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We&#x27;re <em>almost</em> there!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We now know how to make sure that our script is loaded before the rest of the page (and with the help of Next.js&#x27; <code>Document</code>, before <em>any</em> page), but we still need a couple more pieces of this puzzle:</p><ul><li><strong>run</strong> our script as soon as it is loaded.</li><li>change the <code>background-color</code> and other CSS properties based on all the logic we&#x27;ll add!</li></ul><div><h2 id="iifes" style="color:var(--color-primary-accent)"><a href="#iifes" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="iifes" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>IIFEs</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The next piece of our puzzle is figuring out how to run our custom script as soon as possible.
As a reminder, we&#x27;re doing this to figure out the correct state of dark mode (activated/deactivated, or more simply, <code>true</code>/<code>false</code>) to avoid any ungodly &quot;flashes&quot; of toggling when the user loads up our webpage.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Enter <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE" target="_blank" rel="noopener noreferrer">Immediately Invoked Function Expressions</a></span>! (or <strong>IIFEs</strong> for short)</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">An IIFE is simply a JavaScript function that is executed as soon as it is defined. Aside from having the benefit of being run Immediately upon definition, IIFEs are also great when one wants to avoid polluting the global namespace — something that we can definitely use since we have no use for our logic once it has run and set the apt mode.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s what an IIFE looks like:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-js" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token punctuation" style="color:#88898F">(</span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">var</span><span class="token plain"> name </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;Sreetam Das&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  </span><span class="token console class-name" style="color:#51C7DA">console</span><span class="token punctuation" style="color:#88898F">.</span><span class="token method function property-access" style="color:#7BD88F">log</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token comment" style="color:#444;font-style:italic">// &quot;Sreetam Das&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// Variable name is not accessible from the outside scope</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain"></span><span class="token console class-name" style="color:#51C7DA">console</span><span class="token punctuation" style="color:#88898F">.</span><span class="token method function property-access" style="color:#7BD88F">log</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// throws &quot;Uncaught ReferenceError: name is not defined&quot;</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Let&#x27;s add this to our <code>_document.js</code></p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> Document</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  Html</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  Head</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  Main</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  NextScript</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;next/document&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">setInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> preference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">getItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> hasPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">typeof</span><span class="token plain"> preference </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;string&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">/**</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token comment" style="color:#444;font-style:italic">     * If the user has explicitly chosen light or dark,</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token comment" style="color:#444;font-style:italic">     * use it. Otherwise, this value will be null.</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token comment" style="color:#444;font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">hasPreference</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> preference</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">// If there is no saved preference, use a media query</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mediaQuery </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;(prefers-color-scheme: dark)&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mql </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">matchMedia</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">mediaQuery</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> hasPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">typeof</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;boolean&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">hasPreference</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">27</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">?</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">:</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">28</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">29</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">30</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">// default to &#x27;light&#x27;.</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">31</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">32</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">33</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">34</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> colorMode </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">35</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">36</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">37</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// our function needs to be a string</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">38</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> blockingSetInitialColorMode </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token template-string string" style="color:#E3CF65">(function() {</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">39</span><span class="token template-string string" style="color:#E3CF65">        </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#88898F">${</span><span class="token template-string interpolation">setInitialColorMode</span><span class="token template-string interpolation punctuation" style="color:#88898F">.</span><span class="token template-string interpolation function" style="color:#7BD88F">toString</span><span class="token template-string interpolation punctuation" style="color:#88898F">(</span><span class="token template-string interpolation punctuation" style="color:#88898F">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#88898F">}</span><span class="token template-string string" style="color:#E3CF65"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">40</span><span class="token template-string string" style="color:#E3CF65">        setInitialColorMode();</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">41</span><span class="token template-string string" style="color:#E3CF65">})()</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">42</span><span class="token template-string string" style="color:#E3CF65"></span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">43</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">44</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">class</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">MyDocument</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">Document</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">45</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">render</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">46</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">47</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">48</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Head</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">49</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">50</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">51</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">dangerouslySetInnerHTML</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">52</span><span class="token tag script language-javascript" style="color:#FC618D">              __html</span><span class="token tag script language-javascript operator" style="color:#FC618D">:</span><span class="token tag script language-javascript" style="color:#FC618D"> blockingSetInitialColorMode</span><span class="token tag script language-javascript punctuation" style="color:#88898F">,</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">53</span><span class="token tag script language-javascript" style="color:#FC618D">            </span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">54</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">55</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Main</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">56</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">NextScript</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">57</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">58</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">59</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">60</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">61</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We&#x27;re now able to correctly retrieve the appropriate state of our dark mode <em>before</em> the page loads completely! Our final hurdle is now being able to pass this on to our page&#x27;s component so that we can actually apply the preferred dark mode state.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The challenge here is that we need to be able to transfer this piece of information from a pure JS script which is being run before the page and its React components have been loaded completely, and &quot;hydrate&quot; them.</p><div><h2 id="css-variables" style="color:var(--color-primary-accent)"><a href="#css-variables" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="css-variables" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>CSS Variables</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The last step is to update our page with the user&#x27;s preferred theme.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">There are multiple ways to go about this:</p><ul><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">we can use CSS classes for different themes, and switch them programmatically</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">we can use React&#x27;s <code>state</code> and pass a <code>.class</code> as a <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" target="_blank" rel="noopener noreferrer">template literal</a></span></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">we can also use styled-components</p></li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><em>While all of the options seem like possible solutions, they each require a lot more boilerplate to be added</em></p><span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">or we could CSS variables!</span> <p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ"><span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties" target="_blank" rel="noopener noreferrer">CSS Custom Properties</a></span> (also referred to as CSS Variables) allow us to reuse specific values throughout a document. These can be set using custom property notation and accessed using <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/var" target="_blank" rel="noopener noreferrer">the <code>var()</code> function</a></span> like so:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-css" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">CSS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token selector pseudo-class">:root</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#5b34da</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr">A common best practice is to define custom properties on the <a class="typography__StyledLink-sc-1lz7t9v-13 typography__StyledAccentTextLink-sc-1lz7t9v-14 kZHbDD hJihZj"><code>:root</code> pseudo-class</a>, so that it can be applied globally across your HTML document</aside><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The best part about CSS variables is that they are <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">reactive</span>, they remain live throughout the lifetime of the page, and updating them updates the HTML that references them <em>instantly</em>. <em>And</em> they can be updated using JavaScript!</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token comment" style="color:#444;font-style:italic">// setting</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> root </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setProperty</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;--initial-color-mode&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// getting</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> root </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> initial </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">getPropertyValue</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;--initial-color-mode&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// &quot;dark&quot;</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">CSS variables really shine when you want to have to reuse certain values in your CSS; my website uses a few that you can see <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://github.com/sreetamdas/sreetamdas.com/blob/master/pages/_app.tsx" target="_blank" rel="noopener noreferrer">here</a></span></p><h4 id="theres-more">There&#x27;s more!</h4><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We can use <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Howto/Use_data_attributes" target="_blank" rel="noopener noreferrer">HTML attributes</a></span> and since CSS also has access to these attributes, we can assign different values to CSS variables depending on the <code>data-theme</code> attribute that we set, like so:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-css" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">CSS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token selector pseudo-class">:root</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#5b34da</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#000</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-background</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#fff</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-secondary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#358ef1</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain"></span><span class="token selector attribute punctuation" style="color:#88898F">[</span><span class="token selector attribute attr-name" style="color:#51C7DA;font-style:italic">data-theme</span><span class="token selector attribute operator" style="color:#FC618D">=</span><span class="token selector attribute attr-value">&quot;dark&quot;</span><span class="token selector attribute punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#9d86e9</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-secondary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#61dafb</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#fff</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-background</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#000</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token plain"></span><span class="token selector attribute punctuation" style="color:#88898F">[</span><span class="token selector attribute attr-name" style="color:#51C7DA;font-style:italic">data-theme</span><span class="token selector attribute operator" style="color:#FC618D">=</span><span class="token selector attribute attr-value">&quot;batman&quot;</span><span class="token selector attribute punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#ffff00</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">and we can set and remove the attribute pretty easily too:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">userPreference </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setAttribute</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;data-theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// and to remove, setting the &quot;light&quot; mode:</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">removeAttribute</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;data-theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Finally, we&#x27;re now able to pass on the computed dark mode state from our blocking script to our React component.</p><div><h3 id="recap" style="color:var(--color-primary-accent)"><a href="#recap" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="recap" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Recap</h3></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Before we put together everything we have so far, let&#x27;s recap:</p><ul><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">as soon as the webpage is being loaded, we inject and run a blocking script using <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">Next.js&#x27; Document</span> and <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">IIFEs</span></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">check for user&#x27;s saved preference from a previous visit using <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">localStorage</span></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">check if the user has a system-wide dark mode preference using a <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">CSS media query</span></p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">if both above checks are inconclusive, we default to a light theme</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">pass this preference as a <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">CSS variable</span>, which we can read in our toggle component</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">the theme can be toggled, and upon toggling we save the preference for future visits</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">we should <em>never</em> have the <span class="blog__Highlight-sc-1mh1ecb-9 gceaIA">flicker</span> on the first load, even if the user has a preference for the non-default theme</p></li><li><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">we should <em>always</em> show the correct state of our toggle, and defer rendering the toggle if the correct state is unknown</p></li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s what the final result looks like:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> Document</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  Html</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  Head</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  Main</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain">  NextScript</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;next/document&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">setInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> preference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">getItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> hasPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">typeof</span><span class="token plain"> preference </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;string&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">/**</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token comment" style="color:#444;font-style:italic">     * If the user has explicitly chosen light or dark,</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token comment" style="color:#444;font-style:italic">     * use it. Otherwise, this value will be null.</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token comment" style="color:#444;font-style:italic">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">hasPreference</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> preference</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">// If there is no saved preference, use a media query</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mediaQuery </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;(prefers-color-scheme: dark)&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> mql </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> window</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">matchMedia</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">mediaQuery</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> hasPreference </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">typeof</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;boolean&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">hasPreference</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">27</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> mql</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">matches </span><span class="token operator" style="color:#FC618D">?</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">:</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">28</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">29</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">30</span><span class="token plain">    </span><span class="token comment" style="color:#444;font-style:italic">// default to &#x27;light&#x27;.</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">31</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">32</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">33</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">34</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> colorMode </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">getInitialColorMode</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">35</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> root </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">36</span><span class="token plain">  root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setProperty</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;--initial-color-mode&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> colorMode</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">37</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">38</span><span class="token plain">  </span><span class="token comment" style="color:#444;font-style:italic">// add HTML attribute if dark mode</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">39</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">colorMode </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">40</span><span class="token plain">    document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setAttribute</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;data-theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">41</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">42</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">43</span><span class="token plain"></span><span class="token comment" style="color:#444;font-style:italic">// our function needs to be a string</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">44</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> blockingSetInitialColorMode </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token template-string string" style="color:#E3CF65">(function() {</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">45</span><span class="token template-string string" style="color:#E3CF65">        </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#88898F">${</span><span class="token template-string interpolation">setInitialColorMode</span><span class="token template-string interpolation punctuation" style="color:#88898F">.</span><span class="token template-string interpolation function" style="color:#7BD88F">toString</span><span class="token template-string interpolation punctuation" style="color:#88898F">(</span><span class="token template-string interpolation punctuation" style="color:#88898F">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#88898F">}</span><span class="token template-string string" style="color:#E3CF65"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">46</span><span class="token template-string string" style="color:#E3CF65">        setInitialColorMode();</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">47</span><span class="token template-string string" style="color:#E3CF65">})()</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">48</span><span class="token template-string string" style="color:#E3CF65"></span><span class="token template-string template-punctuation string" style="color:#E3CF65">`</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">49</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">50</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">class</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">MyDocument</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#51C7DA">Document</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">51</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">render</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">52</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">53</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">54</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Head</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">55</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">56</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">57</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">dangerouslySetInnerHTML</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">58</span><span class="token tag script language-javascript" style="color:#FC618D">              __html</span><span class="token tag script language-javascript operator" style="color:#FC618D">:</span><span class="token tag script language-javascript" style="color:#FC618D"> blockingSetInitialColorMode</span><span class="token tag script language-javascript punctuation" style="color:#88898F">,</span><span class="token tag script language-javascript" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">59</span><span class="token tag script language-javascript" style="color:#FC618D">            </span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">60</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token script"></span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">script</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">61</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Main</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">62</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">NextScript</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">63</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">body</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">64</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag class-name" style="color:#51C7DA">Html</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">65</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">66</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">67</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Note how we use <code>style.setProperty()</code> as well as <code>documentElement.setAttribute()</code> to pass our data</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Let&#x27;s add our CSS, adding separate values for our CSS variables when dark mode is applied</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-css" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">CSS</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token selector pseudo-class">:root</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#5b34da</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#000</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-background</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#fff</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain"></span><span class="token selector attribute punctuation" style="color:#88898F">[</span><span class="token selector attribute attr-name" style="color:#51C7DA;font-style:italic">data-theme</span><span class="token selector attribute operator" style="color:#FC618D">=</span><span class="token selector attribute attr-value">&quot;dark&quot;</span><span class="token selector attribute punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary-accent</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#9d86e9</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#fff</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">  </span><span class="token variable" style="color:#FD9353;font-style:italic">--color-background</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token hexcode color">#000</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain"></span><span class="token selector">body</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token plain">  </span><span class="token property" style="color:#D7D7D7">background-color</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">var</span><span class="token punctuation" style="color:#88898F">(</span><span class="token variable" style="color:#FD9353;font-style:italic">--color-background</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token plain">  </span><span class="token property" style="color:#D7D7D7">color</span><span class="token punctuation" style="color:#88898F">:</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">var</span><span class="token punctuation" style="color:#88898F">(</span><span class="token variable" style="color:#FD9353;font-style:italic">--color-primary</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Great! Now we need to import these styles into our application.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Since we want these styles to be available throughout our website, we&#x27;ll need to use the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://nextjs.org/docs/advanced-features/custom-app" target="_blank" rel="noopener noreferrer"><code>App</code> component</a></span> that Next.js provides us. This is similar to the <code>Document</code> that we saw earlier, in that it&#x27;s a special component which can be used to control <em>each</em> page in Next.js app as it&#x27;s used to initialise our pages.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">This makes it the correct place for adding our global CSS as well!</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;../styles.css&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">function</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">MyApp</span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter punctuation" style="color:#88898F">{</span><span class="token parameter"> Component</span><span class="token parameter punctuation" style="color:#88898F">,</span><span class="token parameter"> pageProps </span><span class="token parameter punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag class-name" style="color:#51C7DA">Component</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag spread punctuation" style="color:#88898F">{</span><span class="token tag spread punctuation" style="color:#88898F">...</span><span class="token tag spread attr-value" style="color:#FC618D">pageProps</span><span class="token tag spread punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span></div></pre><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">and finally, our React component page:</p><pre class="mdx__CodePreBlockWithHighlight-orgi1d-2 jQffcn prism-code language-jsx" style="color:#f7f1ff;background-color:#0a0e14"><span class="mdx__CodeBlockLanguageWrapper-orgi1d-0 kDocR">JSX</span><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">1</span><span class="token keyword" style="color:#FC618D">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"> useEffect</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">from</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;react&quot;</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">3</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">IndexPage</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">4</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token plain">darkTheme</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> setDarkTheme</span><span class="token punctuation" style="color:#88898F">]</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token function" style="color:#7BD88F">useState</span><span class="token punctuation" style="color:#88898F">(</span><span class="token keyword" style="color:#FC618D">undefined</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">6</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">handleToggle</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter">event</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">7</span><span class="token plain">    </span><span class="token function" style="color:#7BD88F">setDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">target</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">checked</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">8</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">9</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#7BD88F">storeUserSetPreference</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token parameter">pref</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">10</span><span class="token plain">    localStorage</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setItem</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> pref</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">11</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">13</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> root </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">documentElement</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">14</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">useEffect</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">15</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">const</span><span class="token plain"> initialColorValue </span><span class="token operator" style="color:#FC618D">=</span><span class="token plain"> root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token plain">style</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">getPropertyValue</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">16</span><span class="token plain">      </span><span class="token string" style="color:#E3CF65">&quot;--initial-color-mode&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">17</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">18</span><span class="token plain">    </span><span class="token function" style="color:#7BD88F">setDarkTheme</span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">initialColorValue </span><span class="token operator" style="color:#FC618D">===</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">19</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token punctuation" style="color:#88898F">]</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">20</span><span class="token plain">  </span><span class="token function" style="color:#7BD88F">useEffect</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">(</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">21</span><span class="token plain">    </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">darkTheme </span><span class="token operator" style="color:#FC618D">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">undefined</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">22</span><span class="token plain">      </span><span class="token keyword" style="color:#FC618D">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain">darkTheme</span><span class="token punctuation" style="color:#88898F">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">23</span><span class="token plain">        root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">setAttribute</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;data-theme&quot;</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">24</span><span class="token plain">        </span><span class="token function" style="color:#7BD88F">storeUserSetPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;dark&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">25</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">26</span><span class="token plain">        root</span><span class="token punctuation" style="color:#88898F">.</span><span class="token function" style="color:#7BD88F">removeAttribute</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;data-theme&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">27</span><span class="token plain">        </span><span class="token function" style="color:#7BD88F">storeUserSetPreference</span><span class="token punctuation" style="color:#88898F">(</span><span class="token string" style="color:#E3CF65">&quot;light&quot;</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">28</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">29</span><span class="token plain">    </span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">30</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">[</span><span class="token plain">darkTheme</span><span class="token punctuation" style="color:#88898F">]</span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">31</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">32</span><span class="token plain">  </span><span class="token keyword" style="color:#FC618D">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">33</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">34</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">{</span><span class="token plain">darkTheme </span><span class="token operator" style="color:#FC618D">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">undefined</span><span class="token plain"> </span><span class="token operator" style="color:#FC618D">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:#88898F">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">35</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">36</span><span class="token plain">          </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">input</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line highlight-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">37</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#88898F">=</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag attr-value" style="color:#FC618D">checkbox</span><span class="token tag attr-value punctuation" style="color:#88898F">&quot;</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">38</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">checked</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">darkTheme</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">39</span><span class="token tag" style="color:#FC618D">            </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">onChange</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D">handleToggle</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag" style="color:#FC618D"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">40</span><span class="token tag" style="color:#FC618D">          </span><span class="token tag punctuation" style="color:#88898F">/&gt;</span><span class="token punctuation" style="color:#88898F">{</span><span class="token string" style="color:#E3CF65">&quot; &quot;</span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">41</span><span class="token plain">          Dark</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">42</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">label</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">43</span><span class="token plain">      </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">44</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain">Hello there</span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">h1</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">45</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag" style="color:#FC618D"> </span><span class="token tag attr-name" style="color:#51C7DA;font-style:italic">style</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#88898F">=</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript punctuation" style="color:#88898F">{</span><span class="token tag script language-javascript" style="color:#FC618D"> color</span><span class="token tag script language-javascript operator" style="color:#FC618D">:</span><span class="token tag script language-javascript" style="color:#FC618D"> </span><span class="token tag script language-javascript string" style="color:#E3CF65">&quot;var(--color-primary-accent)&quot;</span><span class="token tag script language-javascript" style="color:#FC618D"> </span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag script language-javascript punctuation" style="color:#88898F">}</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">46</span><span class="token plain">        General Kenobi</span><span class="token operator" style="color:#FC618D">!</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">47</span><span class="token plain">      </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">p</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">48</span><span class="token plain">    </span><span class="token tag punctuation" style="color:#88898F">&lt;/</span><span class="token tag" style="color:#FC618D">div</span><span class="token tag punctuation" style="color:#88898F">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">49</span><span class="token plain">  </span><span class="token punctuation" style="color:#88898F">)</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">50</span><span class="token plain"></span><span class="token punctuation" style="color:#88898F">}</span><span class="token punctuation" style="color:#88898F">;</span><span class="token plain"></span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">51</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f7f1ff"><span class="mdx__CodeblockLineNumber-orgi1d-3 cowRVG">52</span><span class="token plain"></span><span class="token keyword" style="color:#FC618D">export</span><span class="token plain"> </span><span class="token keyword" style="color:#FC618D">default</span><span class="token plain"> IndexPage</span><span class="token punctuation" style="color:#88898F">;</span></div></pre><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr">One caveat of our approach using vanilla CSS is that during development, we still experience the &quot;flicker&quot;, but once the application is compiled and built, we no longer do and everything works as intended</aside><aside type="success" class="blog__CustomBlockquote-sc-1mh1ecb-8 ebmwhM">If you&#x27;re using <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://styled-components.com" target="_blank" rel="noopener noreferrer">Styled-components</a></span>, then this isn&#x27;t an issue since we can use <code>ServerStyleSheet()</code> which makes sure that the CSS being imported in <code>App</code> is correctly collected and added to the <code>Document</code> itself, thus preventing the flicker during development as well<br/><br/><span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://styled-components.com/docs/advanced#nextjs" target="_blank" rel="noopener noreferrer">Refer the docs</a></span> or check out <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://github.com/sreetamdas/sreetamdas.com/blob/master/pages/_document.tsx#L10" target="_blank" rel="noopener noreferrer">my implementation</a></span></aside><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Initialising our <code>isDarkTheme</code> state as <code>undefined</code> allows us to defer rendering our dark mode toggle, thus preventing showing the wrong toggle state to the user.</p><div><h2 id="fin" style="color:var(--color-primary-accent)"><a href="#fin" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="fin" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Fin</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">And that&#x27;s it!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">We&#x27;ve got the perfect dark mode, one without any flickering. As <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://joshwcomeau.com/gatsby/dark-mode" target="_blank" rel="noopener noreferrer">Josh mentioned</a></span> this was certainly not an easy task; I definitely didn&#x27;t expect to work with things like CSS variables and IIFEs and I&#x27;m certain you didn&#x27;t either!</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Here&#x27;s a couple of links for you to check out our finished app:</p><aside class="blog__CustomBlockquote-sc-1mh1ecb-8 cmnyGr"><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Live app: <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://nextjs-perfect-dark-mode.netlify.app" target="_blank" rel="noopener noreferrer">nextjs-perfect-dark-mode.netlify.app</a></span></p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Repository: <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://github.com/sreetamdas/nextjs-perfect-dark-mode-example" target="_blank" rel="noopener noreferrer">github.com/sreetamdas/nextjs-perfect-dark-mode-example</a></span></p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Sandbox: <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://codesandbox.io/s/dreamy-nightingale-ikwks?file=/pages/_document.js" target="_blank" rel="noopener noreferrer">codesandbox.io/s/dreamy-nightingale-ikwks</a></span></p></aside><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Of course, there are <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://github.com/donavon/use-dark-mode#that-flash" target="_blank" rel="noopener noreferrer">packages which can handle all of this for you</a></span> including &quot;the flash&quot; which differ only slightly in their implementation (Donavon here uses the <code>.class</code> method). Also, here&#x27;s a great article about the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://www.toptal.com/designers/ui/dark-ui-design" target="_blank" rel="noopener noreferrer">Principles of Dark UI Design</a></span> that I would recommend you check out — it is a great read about the multiple challenges that one needs to take care of while implementing the perfect dark mode.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">At the end of the day there are more and more people adding dark mode to their websites, and hopefully my journey here is able to help implement the perfect one for your website too.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Notice any typos? Have something to say or improvements to add? Feel free to <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://twitter.com/_SreetamDas" target="_blank" rel="noopener noreferrer">reach out to me on Twitter</a></span> and maybe even share this post using the button below :)</p>]]></content>
        <author>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </author>
        <contributor>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </contributor>
    </entry>
    <entry>
        <title type="html"><![CDATA[Over-engineering a Blog]]></title>
        <id>https://sreetamdas.com/blog/over-engineering-a-blog</id>
        <link href="https://sreetamdas.com/blog/over-engineering-a-blog"/>
        <updated>2020-05-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Building this website with Next.js, TypeScript and Styled-components]]></summary>
        <content type="html"><![CDATA[<p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;ve always wanted to have a personal blog (and maintain it!) but I was just never able to get around to it. It&#x27;s 2020 and I didn&#x27;t want to push this any further.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;d experimented with <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a></span> before. It&#x27;s a dead-simple way to host your own blog, but having worked with React over the past couple of years I just didn&#x27;t feel content with just a markdown blog.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;d also peeked at <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://medium.com" target="_blank" rel="noopener noreferrer">Medium</a></span>, but their move to a paywall just didn&#x27;t fit with me. <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://dev.to" target="_blank" rel="noopener noreferrer">DEV</a></span> also looked like a really good option, but I increasingly wanted to host something that was really <em>made by me</em>.</p><div><h2 id="react-with-client-side-rendering" style="color:var(--color-primary-accent)"><a href="#react-with-client-side-rendering" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="react-with-client-side-rendering" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>React with Client-Side rendering</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">The easiest solution would have been to run <code>yarn create react-app my-app</code> and then going berserk (<em>I&#x27;m a yarn user btw /s</em>). If I decided to not go the <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://create-react-app.dev/" target="_blank" rel="noopener noreferrer">CRA</a></span> route and instead use only the packages that I actually need by building everything from scratch, I did have the following benefits:</p><ul><li>I wouldn&#x27;t have <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://news.ycombinator.com/item?id=19195148" target="_blank" rel="noopener noreferrer">over 1500 dependencies</a></span>, some of which I <em>probably</em> don&#x27;t need for a blog</li><li>Let&#x27;s talk about the first point again</li></ul><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">However, using a stock React app also has a one pretty decently sized issue that one notices little by little over time: the dreaded blankness of our HTML while our JavaScript is still being loaded.</p><div><h2 id="the-problem-of-client-side-rendering" style="color:var(--color-primary-accent)"><a href="#the-problem-of-client-side-rendering" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="the-problem-of-client-side-rendering" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>The Problem of Client-Side Rendering</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Whenever you&#x27;ve hit refresh on a vanilla React app, you&#x27;ve probably noticed this: a blank page gets loaded, and there is a (considerable at times) delay when the things start &quot;popping up&quot; on the screen. You check if your WiFi connection is fast enough, but that&#x27;s not the problem 🙁</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">A quick refresher on how React works: Our page&#x27;s HTML loads first, and the HTML defines the JS files that need to be loaded for React to take over things. In the time that the page HTML has been loaded and the JS is yet to be finish loading, the client only sees what has already been loaded at this point, the HTML (and if we&#x27;ve taken care of it, the CSS too!). This problem is especially highlighted when the client has a poor/slow internet connection (you can also experience this in the browser by going over to the <strong>Network</strong> tab in your browser&#x27;s console and selecting an option there, like <strong>slow 3G</strong>).</p><div><h2 id="the-renaissance-of-static" style="color:var(--color-primary-accent)"><a href="#the-renaissance-of-static" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="the-renaissance-of-static" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>The Renaissance of Static</h2></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">To be precise, static websites never really <em>went away</em>. But their introduction into the React ecosystem was pretty much exactly what developers were looking for. So, what exactly are &quot;static&quot; websites and why does just about everyone seem to be in love with them?</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Static websites allow your web application to be <em>server-side rendered</em> (SSR). What this means is that instead of your application consisting of just barebones HTML which needs all of its accompanying JS to be loaded so that the app can be rendered properly, your app gets <em>pre-rendered</em>: using all the data that is available statically, the app (or rather, the DOM) is rendered and we can get access to the (static) app as HTML and CSS.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">Now that our webpage (or at least some parts of it) is available as HTML, our website can be loaded <em>much</em> faster, since there is no waiting time period for the JS to load first!</p><div><h3 id="ide-tooling" style="color:var(--color-primary-accent)"><a href="#ide-tooling" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="ide-tooling" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>IDE Tooling</h3></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">One thing that I&#x27;ve learnt over the last couple of years is that it is almost <em>always</em> better to put in some of that extra effort right in the beginning even if it might seem like overkill since it pays off over the future. This was primarily my takeaway from when rewriting my work codebase using TypeScript; in the early stages it was an absolute pain to learn a not-so-pleasing-to-the-eyes-at-first syntax.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">One of my goals with the rewrite of my website was that I wanted to be able to play around with it. This meant being able to use third-party packages; and TypeScript allows your <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="/uses">IDE</a></span> to use types from respective packages with VSCode&#x27;s IntelliSense.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">In the process of making a more complete specification of the tooling that I wanted to include in my project, I ended up with a spin-off: <span class="mdx__MDXLinkStyled-orgi1d-1 ijJDPr"><a href="https://github.com/sreetamdas/stack" target="_blank" rel="noopener noreferrer"><span class="typography__TextGradient-sc-1lz7t9v-1 ixPlmk"><span class="typography__Heavy-sc-1lz7t9v-2 gvObmX">sreetamdas/stack</span></span></a></span>, a modern-day-tech stack boilerplate for <code>React + TypeScript + Styled Components</code> projects.</p><div><h3 id="css-in-js" style="color:var(--color-primary-accent)"><a href="#css-in-js" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="css-in-js" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>CSS-in-JS</h3></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">I&#x27;ve tried out CSS Modules, but CSS-in-JS just seemed more comfortable.</p><div><h3 id="framework" style="color:var(--color-primary-accent)"><a href="#framework" class="blog__LinkedHeaderIconWrapper-sc-1mh1ecb-7 cEzJA-d"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" aria-label="framework" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a>Framework</h3></div><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">This was a decision between Gatsby and Next.js, and being able to support non-static sites with Next.js was a big reason for going with it. Gatsby does bring with it its huge ecosystem of plugins, as well as top-class support for GraphQL (something that I&#x27;ve been looking forward to working with) but Next.js is an absolute delight to play around with, so I went ahead with my choice.</p><p class="typography__Paragraph-sc-1lz7t9v-9 DmGBQ">And that&#x27;s about it! That&#x27;s the primary stack for this personal website. It&#x27;s open-sourced, so feel free to check it out and contribute if you&#x27;d like 😁</p>]]></content>
        <author>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </author>
        <contributor>
            <name>Sreetam Das</name>
            <email>sreetam@sreetamdas.com</email>
            <uri>https://twitter.com/_SreetamDas</uri>
        </contributor>
    </entry>
</feed>