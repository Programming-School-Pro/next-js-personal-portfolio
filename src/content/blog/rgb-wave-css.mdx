import { Highlight } from "styles/blog";
import { Heavy } from "styles/typography";
import { Sparkles } from "styles/special";
import { ChromaHighlight } from "components/FancyPants";
import { HighlightWithUseEffect } from "components/blog/rgb-text";

export const meta = {
  published: false,
  publishedAt: "2021-04-10",
  title: 'How to "chameleon" your text',
  summary: "",
};

I recently created a [new page on this website](/fancy-pants). From an early time in my frontend journey, I have been amazed by the websites that are featured on [awwwards](https://www.awwwards.com/awwwards/collections/freelance-portfolio/) and I wanted to create something <Highlight><Sparkles>fancy</Sparkles></Highlight> like them.

Here's how I did it.

## What we want to build

Let's take a look again at what we're trying to build here:

<Heavy>
  <ChromaHighlight>Hello there!</ChromaHighlight>
</Heavy>

let's break down what's happening here:

- text color transitions from one color to another
- as soon as it reaches the "target" color, we change it again to keep it changing

## Changing colors

We can animate the color changing of the text by using `transition`:

```css
transition-property: color;
transition-duration: 5s;
transition-timing-function: linear;

/* or in one line */
transition: color 5s linear;
```

And since I'm using `styled-components`, we can put this in a re-usable CSS string:

```js
import { css } from "styled-components";

const WaveMixin = css`
  transition-property: border, color;
  transition-duration: 5s;
  transition-timing-function: linear;
`;
```

But this doesn't do anything at the moment â€” to actually change the color, we will need to update the color of the `<span>` that we are targeting _after_ it has been rendered to the screen.

Let's start writing our little wrapper component for this:

```jsx
// usage
<Highlight>Hi there!</Highlight>;

const Highlight = ({ children }) => {
  return <Wave>{children}</Wave>;
};

// import styled, { css } from "styled-components";
const WaveMixin = css`
  transition-property: border, color;
  transition-duration: 5s;
  transition-timing-function: linear;
`;

const Wave = styled.span`
  ${WaveMixin}
`;
```

And now we change the color once the component has mounted:

```jsx {3-11,14-19,21-23}
<Highlight>Hi there!</Highlight>;

let root: HTMLElement;

const getNewColor = () => {
  const h = random(1, 360);
  const s = random(80, 90);
  const l = random(50, 60);

  return `hsl(${h}, ${s}%, ${l}%)`;
};

const Highlight = ({ children }) => {
  const changeColor = () => {
    const newColor = getNewColor();

    if (root === undefined) root = document?.documentElement;
    root.style.setProperty("--color-chameleon", newColor);
  };

  useEffect(() => {
    changeColor();
  }, []);

  return <Wave>{children}</Wave>;
};

const WaveMixin = css`
  color: var(--color-chameleon);
  transition-property: border, color;
  transition-duration: 5s;
  transition-timing-function: linear;
`;

const Wave = styled.span`
  ${WaveMixin}
`;
```

<Heavy>
  <HighlightWithUseEffect>Hi there!</HighlightWithUseEffect>
</Heavy>

---

## Bonus round! A link's underline

<Heavy>
  <ChromaHighlight link>
    Hi there!
    <br />
    <a href="#">This is a link</a>.
  </ChromaHighlight>
</Heavy>
